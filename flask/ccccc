# services.py

import re

from db import mysql  

def check_user(email, password):
    check_mail=validate_user_email(email)
    if(not check_mail):
        return False
    else:
        con = mysql.connect
        cur = con.cursor()
        cur.execute("SELECT * FROM login WHERE email=%s AND password=%s", (email, password))
        res = cur.fetchone()
        cur.close()
        con.close()
        if res:
            return True
        return False

def registration(name,email,password,confirm_password):
    check_mail=validate_user_email(email)
    if(not check_mail):
        return False
    else:
        if(password==confirm_password):
            con=mysql.connect
            cur=con.cursor()
            cur.execute("insert into registration(name,email,password,date) values(%s,%s,%s,current_date())",(name,email,password))
            con.commit()
            cur.close()
            con.close()
            return True
        else:
            return False
    
def validate_user_email(email):
    res=re.match(r'^([a-z0-9.]+([@][a-z]+)([.][com]))',email)
    if(res):
        return True
    else:
        return False
