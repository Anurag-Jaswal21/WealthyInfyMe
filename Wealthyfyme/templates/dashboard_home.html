
  <title>Dashboard</title> 
  <style>
    .card:hover {
      transform: scale(1.03);
      background-color: #9da6a135; /* green hover */
      transition: transform 0.3s ease, background-color 0.5s ease;
    }

    .summary-card:hover {
      transform: scale(1.03);
      background-color: rgb(22, 116, 34); /* green hover */
      transition: transform 0.3s ease, background-color 0.5s ease;
    }

    .summary-card {
      transition: transform 0.3s ease, background-color 0.3s ease;
    }

    .summary-card:hover h3,
    .summary-card:hover h6,
    .summary-card:hover p,
    .summary-card:hover ion-icon {
      color: white !important;
    }
  </style>
</head>

<body>
{% extends "dashboard.html" %}

{% block title %}Dashboard - WealthifyMe{% endblock %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="mb-0">Dashboard</h1>
  </div>

  <!-- Cards Section -->
  <div class="row mb-4">
    <!-- Total Balance Card -->
    <div class="col-md-4">
      <div class="card border-0 shadow-sm h-100 summary-card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h6 class="card-title text-muted mb-0">Total Balance</h6>
            <ion-icon name="wallet-outline" class="text-success"></ion-icon>
          </div>
          <h3 class="card-text">â‚¹{{ "%.2f"|format(total_balance) }}</h3>
          <p class="text-success small mb-0"><ion-icon name="trending-up-outline"></ion-icon>ðŸŽ‰ Bravo! Great saving!</p>
        </div>
      </div>
    </div>

    <!-- Monthly Income Card -->
    <div class="col-md-4">
      <div class="card border-0 shadow-sm h-100 summary-card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h6 class="card-title text-muted mb-0">Monthly Income</h6>
            <ion-icon name="arrow-down-circle-outline" class="text-primary"></ion-icon>
          </div>
          <h3 class="card-text">â‚¹{{ "%.2f"|format(monthly_income) }}</h3>
          <p class="text-success small mb-0"><ion-icon name="trending-up-outline"></ion-icon> ðŸ‘Œ Keep it up! You're doing good.</p>
        </div>
      </div>
    </div>

    <!-- Monthly Expenses Card -->
    <div class="col-md-4">
      <div class="card border-0 shadow-sm h-100 summary-card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h6 class="card-title text-muted mb-0">Monthly Expenses</h6>
            <ion-icon name="arrow-up-circle-outline" class="text-danger"></ion-icon>
          </div>
          <h3 class="card-text">â‚¹{{ "%.2f"|format(monthly_expenses) }}</h3>
          <p class="text-danger small mb-0"><ion-icon name="trending-down-outline"></ion-icon> Spend carefully!!!</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="row">
    <div class="col-lg-8">
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body">
          <h5 class="card-title">Chart</h5>
          <canvas id="monthlyChart" height="300" class="mb-4"></canvas>


          
        </div>
      </div>
    </div>
    <div class="col-lg-4">
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body">
          <h5 class="card-title">Expenses by Category</h5>
          <div class="mt-3">
            <ul class="list-group">
              {% for category, amount in sorted_categories %}
                <li class="list-group-item d-flex justify-content-between">
                  <span>{{ category }}</span>
                  <span>â‚¹{{ "{:,.2f}".format(amount) }}</span>
                </li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Transactions -->
  <div class="card border-0 shadow-sm" >
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center mb-3" >
        <h5 class="card-title mb-0">Recent Transactions</h5>
        <a href="{{ url_for('transactions') }}" class="btn btn-sm btn-outline-success">View All</a>
      </div>
      <div class="table-responsive" >
        <table class="table table-hover" >
          <thead>
            <tr>
              <th>Date</th>
              <th>Description</th>
              <th>Category</th>
              <th class="text-end">Amount</th>
            </tr>
          </thead>
          <tbody>
            {% for transaction in recent_transactions %}
            <tr>
              <td>{{ transaction.date.strftime('%b %d') }}</td>
              <td>{{ transaction.description }}</td>
              <td><span class="badge bg-light text-dark">{{ transaction.category }}</span></td>
              <td class="text-end {% if transaction.type == 'expense' %}text-danger{% elif transaction.type == 'income' %}text-success{% endif %}">
                â‚¹{{ "%.2f"|format(transaction.amount) }}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Monthly Summary Chart (Bar Chart)
    const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
    
    // Get data from Flask template
    const monthlyData = {{ monthly_data|tojson|safe }};
    
    // Debug: Check the data in console
    console.log("Monthly Data:", monthlyData);
    
    // Create the chart
    const monthlyChart = new Chart(monthlyCtx, {
      type: 'bar',
      data: {
        labels: monthlyData.labels || ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
        datasets: [
          {
            label: 'Income',
            data: monthlyData.income || [1000, 1200, 1300, 1400, 1500, 1600],
            backgroundColor: 'rgba(40, 167, 69, 0.7)', // Green
            borderColor: 'rgba(40, 167, 69, 1)',
            borderWidth: 1
          },
          {
            label: 'Expenses',
            data: monthlyData.expenses || [500, 600, 700, 800, 900, 1000],
            backgroundColor: 'rgba(220, 53, 69, 0.7)', // Red
            borderColor: 'rgba(220, 53, 69, 1)',
            borderWidth: 1
          },
          {
            label: 'Savings',
            data: monthlyData.savings || [500, 600, 600, 600, 600, 600],
            backgroundColor: 'rgba(23, 162, 184, 0.7)', // Blue
            borderColor: 'rgba(23, 162, 184, 1)',
            borderWidth: 1
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'bottom',
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                return `${context.dataset.label}: â‚¹${context.raw.toFixed(2)}`;

              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              callback: function(value) {
                return 'â‚¹' + value;
              }
            }
          }
        }
      }
    });
  });
</script>
{% endblock %}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Category Chart
    const ctx = document.getElementById('categoryChart').getContext('2d');

    const categories = {{ sorted_categories|tojson|safe }};
    const labels = categories.map(item => item[0]);
    const data = categories.map(item => item[1]);

    const categoryChart = new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: labels,
        datasets: [{
          label: 'Expenses by Category',
          data: data,
          backgroundColor: [
            '#dc3545', '#ffc107', '#28a745', '#007bff', '#6610f2', '#17a2b8',
            '#fd7e14', '#20c997', '#6c757d'
          ],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'bottom',
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                return `${context.label}: â‚¹${context.raw.toFixed(2)}`;
              }
            }
          }
        }
      }
    });
  });
</script>

